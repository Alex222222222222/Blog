---
title: "Install K3S on Machine do not have Internet Access"
date: "2024-08-16"
tags: ["k3s", "kubernetes"]
toc: true
categories: ["kubernetes"]
---

# Install K3S on Machine do not have Internet Access

## Introduction

K3S is a lightweight Kubernetes distribution.
It is a great choice for edge computing and IoT devices.
I currently have a machine with only ipv6 access,
and I want to install K3S on it.
Sadly, k3s install script need to download binary from
GitHub, which is known to be not ipv6 friendly currently.

## Solution

First, from the k3s release page download the airgap image,
and transfer it to the machine you want to install k3s on.
Then, download the install script from https://get.k3s.io,
and put it in the same directory as the airgap image,
and make sure the script is executable.

```bash
chmod +x install.sh
```

Then, download the k3s binary from the release page,
and put it into where ever you install executable,
normally it is `/usr/local/bin`.

```bash
mv k3s /usr/local/bin
chmod +x /usr/local/bin/k3s
```

Now, you can run the install script:

```bash
INSTALL_K3S_SKIP_DOWNLOAD=true INSTALL_K3S_EXEC='server --token=SECRET' ./install.sh
```

To join another node to the cluster, you can run:

```bash
INSTALL_K3S_SKIP_DOWNLOAD=true INSTALL_K3S_EXEC='server --server https://server-ip:6443 --token=SECRET' ./install.sh
```